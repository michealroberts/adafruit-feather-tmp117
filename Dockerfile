# Copyright Â© Michael Roberts

# //////////////////////////////////////////////////////////////////////////////////// #

ARG TINY_GO_VERSION="0.39.0"

# //////////////////////////////////////////////////////////////////////////////////// #

FROM mcr.microsoft.com/devcontainers/go:latest AS base

# Ensure GOPATH exists and is writable by the vscode user:
RUN mkdir -p /go && chown -R vscode:vscode /go

# //////////////////////////////////////////////////////////////////////////////////// #

FROM tinygo/tinygo:${TINY_GO_VERSION} AS setup

# //////////////////////////////////////////////////////////////////////////////////// #

FROM base AS development

# Copy the TinyGo installation tree from the setup stage:
COPY --from=setup /usr/local/tinygo /usr/local/tinygo

# Set TINYGOROOT environment variable:
ENV TINYGOROOT=/usr/local/tinygo

ENV PATH="${TINYGOROOT}/bin:${PATH}"

# //////////////////////////////////////////////////////////////////////////////////// #